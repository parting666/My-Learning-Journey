# ğŸš€ Staking DApp - è´¨æŠ¼åˆçº¦é¡¹ç›®

ä¸€ä¸ªå®Œæ•´çš„å»ä¸­å¿ƒåŒ–è´¨æŠ¼åº”ç”¨,åŒ…æ‹¬æ™ºèƒ½åˆçº¦å’Œç°ä»£åŒ–å‰ç«¯ç•Œé¢ã€‚ç”¨æˆ·å¯ä»¥è´¨æŠ¼ ERC20 ä»£å¸å¹¶è‡ªåŠ¨èµšå–å¥–åŠ±ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ™ºèƒ½åˆçº¦
- **StakingToken (STK)**: ERC20 ä»£å¸,ç”¨äºè´¨æŠ¼
- **RewardsToken (RWD)**: ERC20 ä»£å¸,ç”¨äºå¥–åŠ±åˆ†å‘
- **StakingRewards**: æ ¸å¿ƒè´¨æŠ¼åˆçº¦
  - è´¨æŠ¼ä»£å¸èµšå–å¥–åŠ±
  - åŸºäºæ—¶é—´çš„çº¿æ€§å¥–åŠ±åˆ†å‘
  - éšæ—¶æå–æœ¬é‡‘å’Œå¥–åŠ±
  - å¯é…ç½®çš„å¥–åŠ±ç‡
- **StakingFactory**: å·¥å‚åˆçº¦,ç”¨äºéƒ¨ç½²æ–°çš„è´¨æŠ¼æ± 

### å‰ç«¯ç•Œé¢
- ğŸ¨ ç°ä»£åŒ–æ·±è‰²ä¸»é¢˜è®¾è®¡
- ğŸ’ ç»ç’ƒæ€æ•ˆæœå’Œæµç•…åŠ¨ç”»
- ğŸ”— Web3 é’±åŒ…é›†æˆ (MetaMask ç­‰)
- ğŸ“Š å®æ—¶æ•°æ®å±•ç¤º
- âš¡ å¿«é€Ÿäº¤æ˜“å¤„ç†
- ğŸ“± å“åº”å¼è®¾è®¡

## ğŸ“‹ å‰ç½®è¦æ±‚

- Node.js >= 16.0.0
- npm æˆ– yarn
- MetaMask æˆ–å…¶ä»– Web3 é’±åŒ…

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ™ºèƒ½åˆçº¦ä¾èµ–
npm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
cd ..
```

### 2. ç¼–è¯‘åˆçº¦

```bash
npm run compile
```

### 3. è¿è¡Œæµ‹è¯•

```bash
npm test
```

### 4. éƒ¨ç½²åˆçº¦

#### éƒ¨ç½²åˆ°æœ¬åœ°ç½‘ç»œ

```bash
# ç»ˆç«¯ 1: å¯åŠ¨æœ¬åœ° Hardhat èŠ‚ç‚¹
npm run node

# ç»ˆç«¯ 2: éƒ¨ç½²åˆçº¦
npm run deploy:localhost
```

éƒ¨ç½²æˆåŠŸå,åˆçº¦åœ°å€å’Œ ABI ä¼šè‡ªåŠ¨ä¿å­˜åˆ° `frontend/src/config/` ç›®å½•ã€‚

#### éƒ¨ç½²åˆ°æµ‹è¯•ç½‘ (Sepolia)

1. å¤åˆ¶ `.env.example` ä¸º `.env`
2. å¡«å†™ä»¥ä¸‹ä¿¡æ¯:
   ```
   PRIVATE_KEY=your_private_key_here
   SEPOLIA_RPC_URL=https://eth-sepolia.g.alchemy.com/v2/your_api_key
   ```
3. è¿è¡Œéƒ¨ç½²å‘½ä»¤:
   ```bash
   npm run deploy:sepolia
   ```

### 5. å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm run dev
```

å‰ç«¯å°†åœ¨ http://localhost:3000 å¯åŠ¨ã€‚

## ğŸ“– ä½¿ç”¨æŒ‡å—

### è¿æ¥é’±åŒ…

1. æ‰“å¼€åº”ç”¨å,ç‚¹å‡» "Connect Wallet" æŒ‰é’®
2. é€‰æ‹© MetaMask æˆ–å…¶ä»–é’±åŒ…
3. ç¡®è®¤è¿æ¥è¯·æ±‚

### è´¨æŠ¼ä»£å¸

1. åœ¨ "Stake Tokens" åŒºåŸŸè¾“å…¥è¦è´¨æŠ¼çš„æ•°é‡
2. é¦–æ¬¡è´¨æŠ¼éœ€è¦å…ˆç‚¹å‡» "Approve STK" æˆæƒåˆçº¦
3. æˆæƒå®Œæˆå,ç‚¹å‡» "Stake Tokens" è¿›è¡Œè´¨æŠ¼
4. åœ¨é’±åŒ…ä¸­ç¡®è®¤äº¤æ˜“

### æŸ¥çœ‹å¥–åŠ±

- å¥–åŠ±ä¼šå®æ—¶æ˜¾ç¤ºåœ¨ "Earned Rewards" å¡ç‰‡ä¸­
- å¥–åŠ±åŸºäºè´¨æŠ¼æ—¶é—´è‡ªåŠ¨ç´¯ç§¯

### é¢†å–å¥–åŠ±

1. åœ¨ "Manage Rewards" åŒºåŸŸç‚¹å‡» "Claim Rewards"
2. ç¡®è®¤äº¤æ˜“å,å¥–åŠ±ä»£å¸ä¼šå‘é€åˆ°æ‚¨çš„é’±åŒ…

### è§£é™¤è´¨æŠ¼

1. åœ¨ "Withdraw Tokens" åŒºåŸŸè¾“å…¥è¦æå–çš„æ•°é‡
2. ç‚¹å‡» "Withdraw Tokens"
3. ç¡®è®¤äº¤æ˜“

### ä¸€é”®é€€å‡º

ç‚¹å‡» "Exit" æŒ‰é’®å¯ä»¥åŒæ—¶:
- æå–æ‰€æœ‰è´¨æŠ¼çš„ä»£å¸
- é¢†å–æ‰€æœ‰ç´¯ç§¯çš„å¥–åŠ±

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
StakingContracts/
â”œâ”€â”€ contracts/              # æ™ºèƒ½åˆçº¦
â”‚   â”œâ”€â”€ StakingToken.sol   # ERC20 ä»£å¸åˆçº¦
â”‚   â”œâ”€â”€ StakingRewards.sol # è´¨æŠ¼å¥–åŠ±åˆçº¦
â”‚   â””â”€â”€ StakingFactory.sol # å·¥å‚åˆçº¦
â”œâ”€â”€ scripts/               # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ deploy.js
â”œâ”€â”€ test/                  # åˆçº¦æµ‹è¯•
â”‚   â””â”€â”€ StakingRewards.test.js
â”œâ”€â”€ frontend/              # å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/   # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ config/       # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ styles/       # CSS æ ·å¼
â”‚   â”‚   â”œâ”€â”€ App.jsx       # ä¸»åº”ç”¨
â”‚   â”‚   â””â”€â”€ main.jsx      # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ hardhat.config.js      # Hardhat é…ç½®
â””â”€â”€ package.json
```

## ğŸ§ª æµ‹è¯•

è¿è¡Œå®Œæ•´çš„æµ‹è¯•å¥—ä»¶:

```bash
npm test
```

æµ‹è¯•è¦†ç›–:
- âœ… è´¨æŠ¼åŠŸèƒ½
- âœ… å¥–åŠ±è®¡ç®—
- âœ… æå–åŠŸèƒ½
- âœ… å¤šç”¨æˆ·åœºæ™¯
- âœ… æƒé™æ§åˆ¶
- âœ… è¾¹ç•Œæ¡ä»¶

## ğŸ“ åˆçº¦æ¥å£

### StakingRewards

```solidity
// è´¨æŠ¼ä»£å¸
function stake(uint256 amount) external

// æå–ä»£å¸
function withdraw(uint256 amount) external

// é¢†å–å¥–åŠ±
function getReward() external

// é€€å‡º (æå–æ‰€æœ‰ + é¢†å–å¥–åŠ±)
function exit() external

// æŸ¥çœ‹å·²èµšå–çš„å¥–åŠ±
function earned(address account) external view returns (uint256)

// æŸ¥çœ‹è´¨æŠ¼ä½™é¢
function stakedBalance(address account) external view returns (uint256)
```

## ğŸ¨ æŠ€æœ¯æ ˆ

### æ™ºèƒ½åˆçº¦
- Solidity 0.8.20
- Hardhat
- OpenZeppelin Contracts
- Ethers.js

### å‰ç«¯
- React 18
- Vite
- Wagmi (Web3 React Hooks)
- Viem (Ethereum äº¤äº’)
- Vanilla CSS

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… ReentrancyGuard é˜²æ­¢é‡å…¥æ”»å‡»
- âœ… SafeERC20 å®‰å…¨ä»£å¸è½¬è´¦
- âœ… Ownable æƒé™æ§åˆ¶
- âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–
- âœ… OpenZeppelin æ ‡å‡†åº“

## ğŸš€ é«˜çº§åŠŸèƒ½

### åˆ›å»ºè‡ªå®šä¹‰è´¨æŠ¼æ± 

ä½¿ç”¨ StakingFactory åˆçº¦å¯ä»¥åˆ›å»ºæ–°çš„è´¨æŠ¼æ± :

```javascript
// éƒ¨ç½²æ–°çš„ ERC20 ä»£å¸
const tokenAddress = await factory.deployToken("My Token", "MTK", 1000000);

// åˆ›å»ºè´¨æŠ¼æ± 
const poolAddress = await factory.createStakingPool(
  stakingTokenAddress,
  rewardsTokenAddress,
  rewardRate
);
```

### è°ƒæ•´å¥–åŠ±ç‡

åˆçº¦æ‰€æœ‰è€…å¯ä»¥è°ƒæ•´å¥–åŠ±ç‡:

```javascript
await stakingRewards.setRewardRate(newRate);
```

## ğŸ“Š å¥–åŠ±è®¡ç®—

å¥–åŠ±åŸºäºä»¥ä¸‹å…¬å¼è®¡ç®—:

```
ç”¨æˆ·å¥–åŠ± = (ç”¨æˆ·è´¨æŠ¼é‡ / æ€»è´¨æŠ¼é‡) Ã— å¥–åŠ±ç‡ Ã— æ—¶é—´
```

- **å¥–åŠ±ç‡**: æ¯ç§’åˆ†å‘çš„ä»£å¸æ•°é‡
- **æ—¶é—´**: è´¨æŠ¼æŒç»­æ—¶é—´(ç§’)
- **æ¯”ä¾‹åˆ†é…**: æ ¹æ®ç”¨æˆ·è´¨æŠ¼å æ¯”åˆ†é…å¥–åŠ±

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request!

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ”— ç›¸å…³é“¾æ¥

- [Hardhat æ–‡æ¡£](https://hardhat.org/docs)
- [OpenZeppelin](https://docs.openzeppelin.com/)
- [Wagmi æ–‡æ¡£](https://wagmi.sh/)
- [Viem æ–‡æ¡£](https://viem.sh/)

## â“ å¸¸è§é—®é¢˜

### å¦‚ä½•è·å–æµ‹è¯•ä»£å¸?

åœ¨æœ¬åœ°ç½‘ç»œä¸Š,éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨åˆ†é…ä»£å¸ã€‚åœ¨æµ‹è¯•ç½‘ä¸Š,æ‚¨éœ€è¦:
1. è·å–æµ‹è¯•ç½‘ ETH (ä» faucet)
2. è°ƒç”¨ä»£å¸åˆçº¦çš„ `mint` å‡½æ•°

### å¥–åŠ±ç‡å¦‚ä½•è®¾ç½®?

å¥–åŠ±ç‡ä»¥ wei ä¸ºå•ä½,è¡¨ç¤ºæ¯ç§’åˆ†å‘çš„ä»£å¸æ•°é‡ã€‚ä¾‹å¦‚:
- `0.0001 tokens/second` = `parseEther("0.0001")`
- å¹´åŒ–çº¦ 3,153 ä»£å¸ (0.0001 Ã— 60 Ã— 60 Ã— 24 Ã— 365)

### å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªè´¨æŠ¼æ± å—?

å¯ä»¥!ä½¿ç”¨ StakingFactory å¯ä»¥éƒ¨ç½²å¤šä¸ªç‹¬ç«‹çš„è´¨æŠ¼æ± ,æ¯ä¸ªæ± å¯ä»¥æœ‰ä¸åŒçš„:
- è´¨æŠ¼ä»£å¸
- å¥–åŠ±ä»£å¸
- å¥–åŠ±ç‡

---

**äº«å—è´¨æŠ¼å’Œèµšå–å¥–åŠ±çš„ä¹è¶£! ğŸ‰**
